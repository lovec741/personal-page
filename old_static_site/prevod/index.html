<html>
<head> 
<style>
	body {
		font-family: arial; 
		margin: 20px; 
		background: rgb(240,240,240);
		zoom: 300%;
	}
	body > div{
		visibility: collapse;
		display: none;
		box-shadow: none;
	}
	div#not {
		visibility: visible;
		display: block;
	}
	#1 {
		height: 10%;
		left: 5%; 
		right: 35%;
	}
</style>
</head>
<body>
<div id="not">
<input id="inp1" type="text" placeholder="PŘEVEĎ"/>
<input id="inp2" type="text" placeholder="NA"/>
<button id="convert_button" onclick='convert(document.getElementById("inp1").value, document.getElementById("inp2").value)'>Převést</button>
<p id="typ_prevodu"></p>
<p id="res"></p>
</div>
<script>
var conversion_table = {
"délka": {"m": 1, "pm":1/10**12, "nm":1/10**9, "μm":1/10**6, "picom":1/10**6, "mm":1/1000, "cm": 1/100, "in": 0.0254, "dm": 1/10, "ft": 0.3048, "yd": 0.9144, "km": 1000, "mi": 1609.344, "nmi": 1852},
"váha": {"kg": 1, "t": 1000, "g": 1/1000, "mg": 1/10**6, "μg": 1/10**9, "picog": 1/10**9, "q": 100, "lb": 0.45359237, "oz": 0.0283495231, "ct": 0.0002, "gr": 0.00006479891, "st": 6.35029318},
"rychlost": {"km/h": 1, "km/s": 3600, "m/s": 3.6, "kn": 1.852, "mph": 1.609344, "ftps": 1.09728, "inps": 0.09144, "km/min": 60},
"čas": {"s": 1, "min": 60, "h": 3600, "d": 86400, "wk": 604800, "a": 86400*365.25, "y": 86400*365, "ms": 1/1000, "μs": 1/10**6, "ps": 1/10**12},
"obsah": {"m2": 1, "dm2": 1/10**2, "cm2": 1/10**4, "mm2": 1/10**6, "μm2": 1/10**12, "km2": 1000**2, "ha": 10000, "a": 100, "ac": 4046.856, "mi2": 2589988.11, "yd2": 0.83612736, "in2":0.00064516, "rd2": 25.2928526},
"objem": {"m3": 1, "dm3": 1/10**3, "cm3": 1/10**6, "mm3": 1/10**9, "km3": 1000**3, "hl": 0.1, "l": 1/1000, "dl": 1/10**4, "cl": 1/10**5, "ml": 1/10**6, "mi3": 1609.344**3, "yd3": 0.764554858, "in3":0.0254**3, "af3": 1234},
"energie": {"J": 1, "kJ": 1000},
"teplota": {"°C": 1, "K": [1, 273.15], "°F": [5/9, 32]}
}
document.getElementById("inp1").addEventListener("keyup", function(event) {
  if (event.keyCode === 13) {
    document.getElementById("convert_button").click()
  }
})
document.getElementById("inp2").addEventListener("keyup", function(event) {
  if (event.keyCode === 13) {
    document.getElementById("convert_button").click()
  }
})
typ_prevodu_element = document.getElementById("typ_prevodu")
result_element = document.getElementById("res")
function convert(amount, unit) {
	amount = amount.replace(",",".")
	var conversion_list = Object.keys(conversion_table)
	var conversion_type = ""
	amount_cont = eval(/([-*\d\.,*/+-]{0,}) {0,}(°*\w.{0,})/.exec(amount)[1])
	amount_unit = /([-*\d\.,*/+-]{0,}) {0,}(°*\w.{0,})/.exec(amount)[2]
	if (amount_cont == undefined) {
		amount_cont = 0
	}
	//console.log(/([\d\.*/+-]{0,}) {0,}((\w).{0,})/.exec(amount))
	for (var i = 0; i < conversion_list.length; i++) {
		if (Object.keys(conversion_table[conversion_list[i]]).includes(amount_unit)) {
			if (Object.keys(conversion_table[conversion_list[i]]).includes(unit)) {
				conversion_type = conversion_list[i]
			}
		}
	}
	typ_prevodu_element.innerHTML = conversion_type.toUpperCase()
	if (Number.isInteger(parseInt(amount_unit))) {
		result_element.innerHTML = eval(amount)
	}
	else if (conversion_type != "") {
		if (typeof(conversion_table[conversion_type][amount_unit]) == "object") { // this is for units that also have to add (like temperature)
			var a = (amount_cont-conversion_table[conversion_type][amount_unit][1])*conversion_table[conversion_type][amount_unit][0]
		} else {
			var a = amount_cont*conversion_table[conversion_type][amount_unit]
		}
		if (typeof(conversion_table[conversion_type][unit]) == "object") { // this is for units that also have to add (like temperature)
			var b = conversion_table[conversion_type][unit][0]
			var c = conversion_table[conversion_type][unit][1]
		} else {
			var c = 0
			var b = conversion_table[conversion_type][unit]
		}
		result_element.innerHTML = (parseFloat((a/b+c).toPrecision(12))+" "+unit).replace(".",",")
	} else {
		if (amount_unit.includes("/")) {
		if (!unit.includes("/")) {result_element.innerHTML = "Jednotky \"" + amount_unit + "\" and \"" + unit + "\" neznám, neexistují a nebo nepatří ke stejné veličině.";return false}
		amount_unit = amount_unit.split("/")
		unit = unit.split("/")
		conversion_type = []
	for (var x = 0; x < 2; x++) {
	for (var i = 0; i < conversion_list.length; i++) {
		if (Object.keys(conversion_table[conversion_list[i]]).includes(amount_unit[x])) {
			if (Object.keys(conversion_table[conversion_list[i]]).includes(unit[x])) {
				conversion_type.push(conversion_list[i])
			}
		}
	}
	if (conversion_type.length == 2) {
		if (conversion_type[0] == "délka" && conversion_type[1] == "čas") {
			typ_prevodu_element.innerHTML = "RYCHLOST"
		}
		let x = amount_cont*(conversion_table[conversion_type[0]][amount_unit[0]]/conversion_table[conversion_type[1]][amount_unit[1]])/(conversion_table[conversion_type[0]][unit[0]]/conversion_table[conversion_type[1]][unit[1]])
		result_element.innerHTML = (parseFloat(x.toPrecision(12))+" "+unit.join("/")).replace(".",",")
	}
	else {
		result_element.innerHTML = "Jednotky \"" + amount_unit.join("/") + "\" a \"" + unit.join("/") + "\" neznám, neexistují a nebo nepatří ke stejné veličině."
	}
	}} else {
		result_element.innerHTML = "Jednotky \"" + amount_unit + "\" a \"" + unit + "\" neznám, neexistují a nebo nepatří ke stejné veličině."
	}
	}
}
</script>
</body>
</html>