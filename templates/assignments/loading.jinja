{% extends "assignments/base.jinja" %}

{% block title %}Assignments Overview{% endblock %}

{% block content %}
<div class="d-flex justify-content-center align-items-center" style="height: 100vh;">
    <div class="text-center">
        <div class="spinner-border text-light" role="status" style="width: 3rem; height: 3rem;">
            <span class="visually-hidden">Loading...</span>
        </div>
        <p class="mt-3">Collecting data... Takes around 15s</p>
    </div>
</div>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const username = localStorage.getItem('username');
        const password = localStorage.getItem('password');
        const hiddenCourses = localStorage.getItem('hiddenCourses') || [];
        
        if (!username || !password) {
            window.location.href = '{{ url_for("assignments_login") }}';
            return;
        }
        
        const form = document.createElement('form');
        form.method = 'POST';
        form.action = window.location.href;
        form.style.display = 'none';
        
        const inputs = [
            { name: 'username', value: username },
            { name: 'password', value: password },
            { name: 'hiddenCourses', value: hiddenCourses }
        ];
        
        inputs.forEach(input => {
            const inputElement = document.createElement('input');
            inputElement.type = 'hidden';
            inputElement.name = input.name;
            inputElement.value = input.value;
            form.appendChild(inputElement);
        });
        
        document.body.appendChild(form);
        form.submit();
    });
</script>

{% endblock %}
